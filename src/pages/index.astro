---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
---

<BaseLayout>
  <Header />
  
  <main>
    <!-- Logo and Services Section -->
    <section class="relative bg-black py-12 px-4 border-b-4 border-brand-yellow">
      <div class="max-w-6xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
          <!-- Left Column - Logo -->
          <div class="text-center lg:text-left">
            <img src="/images/logo.png" alt="Stumpmasters Jax" class="mx-auto lg:mx-0 w-full h-auto mb-6" style="max-width: 576px;" />
            <p class="text-xl md:text-2xl text-white mb-6">
              Jacksonville's Premier Stump Grinding Specialists
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start">
              <a 
                href="tel:+19044082450"
                class="px-8 py-3 bg-brand-yellow text-black text-lg font-bold rounded hover:bg-yellow-400 transition"
                onclick="trackEvent('Click', { category: 'Contact', label: 'Hero CTA' })"
              >
                ðŸ“ž Call 904-408-2450
              </a>
              <button 
                id="open-estimate-modal"
                class="px-8 py-3 bg-white text-black text-lg font-bold rounded hover:bg-gray-200 transition"
              >
                Get Free Estimate
              </button>
            </div>
          </div>
          
          <!-- Right Column - Our Services -->
          <div id="services">
            <h2 class="text-4xl font-bold text-brand-yellow mb-4">Our Services</h2>
            <div class="w-24 h-1 bg-brand-yellow mb-8"></div>
            <div class="space-y-6">
              {[
                { 
                  title: 'Stump Grinding/Cutting', 
                  desc: 'Professional stump grinding services that remove stumps below ground level, allowing you to reclaim your yard space. We use state-of-the-art equipment for efficient and safe removal.'
                },
                { 
                  title: 'Tree Trimming', 
                  desc: 'Professional tree trimming and maintenance to keep your trees healthy and your property safe. From routine pruning to storm damage cleanup, we handle it all.'
                },
              ].map(service => (
                <div class="bg-gray-700 border-l-4 border-brand-yellow p-6 hover:bg-gray-600 transition">
                  <h3 class="text-2xl font-bold text-brand-yellow mb-3">{service.title}</h3>
                  <p class="text-gray-300 leading-relaxed">{service.desc}</p>
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- About Us -->
    <section id="about" class="py-16 px-4 bg-gray-700">
      <div class="max-w-6xl mx-auto">
        <h2 class="text-4xl font-bold text-brand-yellow text-center mb-4">About Us</h2>
        <div class="w-24 h-1 bg-brand-yellow mx-auto mb-12"></div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center mb-12">
          <div>
            <h3 class="text-2xl font-bold text-white mb-4">Professional Stump Grinding Services</h3>
            <p class="text-gray-300 leading-relaxed mb-4">
              Stumpmasters Jax is Jacksonville's premier stump grinding specialist, proudly serving Duval, St. Johns, and Clay Counties. As a veteran-owned and operated business, we bring military precision and dedication to every project.
            </p>
            <p class="text-gray-300 leading-relaxed mb-4">
              We provide professional quotes for both residential and commercial projects of all sizes. Whether you're a homeowner looking to clear your yard or a business managing property maintenance, we have the expertise and equipment to handle your needs.
            </p>
            <p class="text-gray-300 leading-relaxed mb-4">
              We are fully licensed and insured, providing you with peace of mind while we handle your stump removal needs. Our team uses state-of-the-art equipment and years of experience to deliver exceptional results.
            </p>
            <p class="text-gray-300 leading-relaxed mb-4">
              Whether you need stump grinding, complete removal, or tree trimming services, we offer free same-day estimates over the phone. Contact us today to reclaim your yard space!
            </p>
            <p class="text-gray-300 leading-relaxed">
              <strong class="text-brand-yellow">Military & Veteran Discount:</strong> As a veteran-owned business, we're proud to offer <strong class="text-white">10% off</strong> the quoted price for all active military members and veterans. Thank you for your service!
            </p>
          </div>
          <div class="bg-black border-2 border-brand-yellow rounded-lg p-8">
            <h4 class="text-xl font-bold text-brand-yellow mb-6 text-center">Why Choose Us?</h4>
            <ul class="space-y-4">
              <li class="flex items-start gap-3">
                <span class="text-brand-yellow text-xl">âœ“</span>
                <span class="text-gray-300"><strong class="text-white">Licensed & Insured:</strong> Fully certified for your protection</span>
              </li>
              <li class="flex items-start gap-3">
                <span class="text-brand-yellow text-xl">âœ“</span>
                <span class="text-gray-300"><strong class="text-white">Free Estimates:</strong> Same-day, over-the-phone quotes</span>
              </li>
              <li class="flex items-start gap-3">
                <span class="text-brand-yellow text-xl">âœ“</span>
                <span class="text-gray-300"><strong class="text-white">Residential & Commercial:</strong> Projects of all sizes</span>
              </li>
              <li class="flex items-start gap-3">
                <span class="text-brand-yellow text-xl">âœ“</span>
                <span class="text-gray-300"><strong class="text-white">Professional Equipment:</strong> State-of-the-art machinery</span>
              </li>
              <li class="flex items-start gap-3">
                <span class="text-brand-yellow text-xl">âœ“</span>
                <span class="text-gray-300"><strong class="text-white">Veteran-Owned:</strong> Military precision and dedication</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </section>
    
    <!-- Photo Carousel - Commented out for now, will add photos later -->
    <!--
    <section class="bg-gray-900 py-12 px-4">
      <div class="max-w-6xl mx-auto">
        <div id="carousel" class="relative overflow-hidden rounded-lg" style="height: 400px;">
          <div class="carousel-slide absolute inset-0 transition-opacity duration-500">
            <div class="w-full h-full bg-gray-800 flex items-center justify-center border-2 border-brand-yellow">
              <div class="text-center">
                <p class="text-gray-400 text-xl mb-2">Before & After Photo 1</p>
                <p class="text-gray-500 text-sm">Replace with actual project photo</p>
              </div>
            </div>
          </div>
          <div class="carousel-slide absolute inset-0 transition-opacity duration-500 opacity-0">
            <div class="w-full h-full bg-gray-800 flex items-center justify-center border-2 border-brand-yellow">
              <div class="text-center">
                <p class="text-gray-400 text-xl mb-2">Before & After Photo 2</p>
                <p class="text-gray-500 text-sm">Replace with actual project photo</p>
              </div>
            </div>
          </div>
          <div class="carousel-slide absolute inset-0 transition-opacity duration-500 opacity-0">
            <div class="w-full h-full bg-gray-800 flex items-center justify-center border-2 border-brand-yellow">
              <div class="text-center">
                <p class="text-gray-400 text-xl mb-2">Before & After Photo 3</p>
                <p class="text-gray-500 text-sm">Replace with actual project photo</p>
              </div>
            </div>
          </div>
          
          <button id="prev-btn" class="absolute left-4 top-1/2 -translate-y-1/2 bg-brand-yellow text-black p-3 rounded-full hover:bg-yellow-400 transition z-10">
            â€¹
          </button>
          <button id="next-btn" class="absolute right-4 top-1/2 -translate-y-1/2 bg-brand-yellow text-black p-3 rounded-full hover:bg-yellow-400 transition z-10">
            â€º
          </button>
          
          <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 z-10">
            <button class="carousel-indicator w-3 h-3 rounded-full bg-brand-yellow" data-slide="0"></button>
            <button class="carousel-indicator w-3 h-3 rounded-full bg-gray-500" data-slide="1"></button>
            <button class="carousel-indicator w-3 h-3 rounded-full bg-gray-500" data-slide="2"></button>
          </div>
        </div>
      </div>
    </section>
    -->
    
    
    <!-- Contact Us -->
    <section id="contact" class="py-16 px-4 bg-black">
      <div class="max-w-6xl mx-auto">
        <h2 class="text-4xl font-bold text-brand-yellow text-center mb-4">Contact Us</h2>
        <div class="w-24 h-1 bg-brand-yellow mx-auto mb-12"></div>
        
        <div class="max-w-4xl mx-auto">
          <h3 class="text-2xl font-bold text-white mb-8 text-center">Get Your Free Estimate Today</h3>
          <p class="text-gray-300 mb-12 leading-relaxed text-center">
            Ready to remove that stump? Contact us for a free, same-day estimate. We serve Jacksonville and surrounding areas including Duval, St. Johns, and Clay Counties.
          </p>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="flex items-start gap-4">
              <div class="bg-brand-yellow p-3 rounded">
                <svg class="w-6 h-6 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                </svg>
              </div>
              <div>
                <p class="text-sm text-gray-400 mb-1">Phone</p>
                <a href="tel:+19044082450" class="text-xl text-white hover:text-brand-yellow transition font-semibold" onclick="trackEvent('Click', { category: 'Contact', label: 'Contact Section Phone' })">
                  904-408-2450
                </a>
              </div>
            </div>
            
            <div class="flex items-start gap-4">
              <div class="bg-brand-yellow p-3 rounded">
                <svg class="w-6 h-6 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                </svg>
              </div>
              <div>
                <p class="text-sm text-gray-400 mb-1">Email</p>
                <a href="mailto:stumpmastersjax@gmail.com" class="text-xl text-white hover:text-brand-yellow transition font-semibold" onclick="trackEvent('Click', { category: 'Contact', label: 'Contact Section Email' })">
                  stumpmastersjax@gmail.com
                </a>
              </div>
            </div>
            
            <div class="flex items-start gap-4">
              <div class="bg-brand-yellow p-3 rounded">
                <svg class="w-6 h-6 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
              </div>
              <div>
                <p class="text-sm text-gray-400 mb-1">Service Area</p>
                <p class="text-xl text-white font-semibold">Jacksonville, FL</p>
                <p class="text-gray-300">Duval, St. Johns & Clay Counties</p>
              </div>
            </div>
            
            <div class="flex items-start gap-4">
              <div class="bg-brand-yellow p-3 rounded">
                <svg class="w-6 h-6 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
              </div>
              <div>
                <p class="text-sm text-gray-400 mb-1">Hours</p>
                <p class="text-xl text-white font-semibold">Monday - Friday</p>
                <p class="text-gray-300">7:00 AM - 7:00 PM</p>
              </div>
            </div>
          </div>
          
          <!-- Social Media Links -->
          <div class="mt-12 pt-8 border-t border-gray-800">
            <h4 class="text-xl font-bold text-white mb-6 text-center">Connect With Us</h4>
            <div class="flex justify-center gap-6">
              <a href="#" class="bg-brand-yellow p-4 rounded-lg hover:bg-yellow-400 transition transform hover:scale-110" aria-label="Facebook">
                <svg class="w-8 h-8 text-black" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                </svg>
              </a>
              <a href="#" class="bg-brand-yellow p-4 rounded-lg hover:bg-yellow-400 transition transform hover:scale-110" aria-label="Instagram">
                <svg class="w-8 h-8 text-black" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                </svg>
              </a>
              <a href="#" class="bg-brand-yellow p-4 rounded-lg hover:bg-yellow-400 transition transform hover:scale-110" aria-label="Google Business">
                <svg class="w-8 h-8 text-black" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12.48 10.92v3.28h7.84c-.24 1.84-.853 3.187-1.787 4.133-1.147 1.147-2.933 2.4-6.053 2.4-4.827 0-8.6-3.893-8.6-8.72s3.773-8.72 8.6-8.72c2.6 0 4.507 1.027 5.907 2.347l2.307-2.307C18.747 1.44 16.133 0 12.48 0 5.867 0 .307 5.387.307 12s5.56 12 12.173 12c3.573 0 6.267-1.173 8.373-3.36 2.16-2.16 2.84-5.213 2.84-7.667 0-.76-.053-1.467-.173-2.053H12.48z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
  
  <Footer />
  
  <!-- Estimate Request Modal -->
  <div id="estimate-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4">
    <div class="bg-gray-700 border-2 border-brand-yellow rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
      <div class="p-6">
        <div id="modal-header" class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-bold text-brand-yellow">Request a Free Estimate</h3>
          <button id="close-modal" class="text-gray-400 hover:text-white text-3xl leading-none">&times;</button>
        </div>
        
        <p id="modal-description" class="text-gray-300 mb-6">
          Fill out the form below and we'll contact you back with a free estimate!
        </p>
        
        <form id="estimate-form" action="https://api.web3forms.com/submit" method="POST" class="space-y-4">
          <!-- Name -->
          <div>
            <label for="name" class="block text-white font-semibold mb-2">Name *</label>
            <input 
              type="text" 
              id="name" 
              name="name" 
              required
              class="w-full px-4 py-3 bg-black border border-gray-700 rounded text-white focus:border-brand-yellow focus:outline-none"
              placeholder="First name, last name"
            />
          </div>
          
          <!-- Address -->
          <div>
            <label for="address" class="block text-white font-semibold mb-2">Service Address *</label>
            <input 
              type="text" 
              id="address" 
              name="address" 
              required
              autocomplete="street-address"
              class="w-full px-4 py-3 bg-black border border-gray-700 rounded text-white focus:border-brand-yellow focus:outline-none"
              placeholder="Street address, city, state, zip"
            />
          </div>
          
          <!-- Phone -->
          <div>
            <label for="phone" class="block text-white font-semibold mb-2">Phone Number *</label>
            <input 
              type="tel" 
              id="phone" 
              name="phone" 
              required
              pattern="[0-9]{3}-?[0-9]{3}-?[0-9]{4}"
              title="Please match the requested format (e.g., 904-555-1234 or 9045551234)"
              class="w-full px-4 py-3 bg-black border border-gray-700 rounded text-white focus:border-brand-yellow focus:outline-none"
              placeholder="904-555-1234"
            />
          </div>
          
          <!-- Email -->
          <div>
            <label for="email" class="block text-white font-semibold mb-2">Email *</label>
            <input 
              type="email" 
              id="email" 
              name="email" 
              required
              title="Please match the requested format (e.g., yourname@example.com)"
              class="w-full px-4 py-3 bg-black border border-gray-700 rounded text-white focus:border-brand-yellow focus:outline-none"
              placeholder="your.email@example.com"
            />
          </div>
          
          <!-- Job Description -->
          <div>
            <label for="description" class="block text-white font-semibold mb-2">Job Description *</label>
            <textarea 
              id="description" 
              name="description" 
              required
              rows="5"
              class="w-full px-4 py-3 bg-black border border-gray-700 rounded text-white focus:border-brand-yellow focus:outline-none resize-vertical scrollbar-thin scrollbar-thumb-brand-yellow scrollbar-track-gray-800"
              placeholder="Please describe the stump grinding or tree service you need. Include details like number of stumps, approximate size, and any special considerations."
            ></textarea>
          </div>
          
          <!-- Contact Preference -->
          <div>
            <label class="block text-white font-semibold mb-3">How do you prefer to be contacted? *</label>
            <div class="flex flex-wrap gap-4">
              <label class="flex items-center gap-2 cursor-pointer group">
                <input 
                  type="radio" 
                  name="contact_preference" 
                  value="Text"
                  required
                  class="w-5 h-5 bg-black border-2 border-gray-600 text-brand-yellow focus:ring-2 focus:ring-brand-yellow checked:bg-brand-yellow checked:border-brand-yellow"
                />
                <span class="text-gray-300 group-hover:text-white transition">Text</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer group">
                <input 
                  type="radio" 
                  name="contact_preference" 
                  value="Call"
                  required
                  class="w-5 h-5 bg-black border-2 border-gray-600 text-brand-yellow focus:ring-2 focus:ring-brand-yellow checked:bg-brand-yellow checked:border-brand-yellow"
                />
                <span class="text-gray-300 group-hover:text-white transition">Call</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer group">
                <input 
                  type="radio" 
                  name="contact_preference" 
                  value="Email"
                  required
                  class="w-5 h-5 bg-black border-2 border-gray-600 text-brand-yellow focus:ring-2 focus:ring-brand-yellow checked:bg-brand-yellow checked:border-brand-yellow"
                />
                <span class="text-gray-300 group-hover:text-white transition">Email</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer group">
                <input 
                  type="radio" 
                  name="contact_preference" 
                  value="Any"
                  required
                  class="w-5 h-5 bg-black border-2 border-gray-600 text-brand-yellow focus:ring-2 focus:ring-brand-yellow checked:bg-brand-yellow checked:border-brand-yellow"
                />
                <span class="text-gray-300 group-hover:text-white transition">Any</span>
              </label>
            </div>
          </div>
          
          <!-- Web3Forms Configuration -->
          <input type="hidden" name="access_key" value="5225be27-8091-4720-85d5-36e4badcea83" />
          <input type="hidden" id="form-subject" name="subject" value="New Estimate Request" />
          <input type="hidden" name="from_name" value="StumpMasters Jax Website" />
          <input type="hidden" name="redirect" value="false" />
          
          <!-- Privacy Disclaimer -->
          <div class="pt-4 pb-2 border-t border-gray-700">
            <p class="text-xs text-gray-400 leading-relaxed">
              <strong class="text-gray-300">Privacy Notice:</strong> By submitting this form, you authorize Stumpmasters Jax to contact you via phone, text, or email regarding the services described above. We respect your privacy and will only use your information to provide you with an estimate and related services. We do not sell, share, or store your personal data beyond what is necessary to fulfill your service request.
            </p>
          </div>
          
          <!-- Form Actions -->
          <div class="flex gap-4 pt-2">
            <button 
              type="submit"
              class="flex-1 px-6 py-3 bg-brand-yellow text-black font-bold rounded hover:bg-yellow-400 transition"
            >
              Submit Request
            </button>
            <button 
              type="button"
              id="cancel-modal"
              class="px-6 py-3 bg-gray-700 text-white font-bold rounded hover:bg-gray-600 transition"
            >
              Cancel
            </button>
          </div>
        </form>
        
        <!-- Success Message (hidden by default) -->
        <div id="success-message" class="hidden mt-6 p-8 bg-black border-4 border-brand-yellow rounded-lg shadow-2xl">
          <div class="text-center">
            <div class="inline-block p-4 bg-brand-yellow rounded-full mb-4">
              <svg class="w-12 h-12 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
              </svg>
            </div>
            <h4 class="text-3xl font-bold text-brand-yellow mb-3">Quote Submitted Successfully!</h4>
            <div class="w-24 h-1 bg-brand-yellow mx-auto mb-4"></div>
            <p class="text-white text-lg leading-relaxed">
              Thank you for your request. We've received your information and will be reaching out to you shortly with your free estimate. We look forward to serving you!
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Estimate Modal Script -->
  <script>
    // Modal elements
    const modal = document.getElementById('estimate-modal');
    const openBtn = document.getElementById('open-estimate-modal');
    const closeBtn = document.getElementById('close-modal');
    const cancelBtn = document.getElementById('cancel-modal');
    const form = document.getElementById('estimate-form');
    const successMessage = document.getElementById('success-message');
    const modalHeader = document.getElementById('modal-header');
    const modalDescription = document.getElementById('modal-description');
    
    // Open modal
    openBtn?.addEventListener('click', () => {
      modal?.classList.remove('hidden');
      document.body.style.overflow = 'hidden'; // Prevent background scroll
    });
    
    // Close modal function
    function closeModal() {
      modal?.classList.add('hidden');
      document.body.style.overflow = ''; // Restore scroll
      form?.reset();
      successMessage?.classList.add('hidden');
      // Show header and description again
      modalHeader?.classList.remove('hidden');
      modalDescription?.classList.remove('hidden');
    }
    
    // Close button
    closeBtn?.addEventListener('click', closeModal);
    
    // Cancel button
    cancelBtn?.addEventListener('click', closeModal);
    
    // Close on Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !modal?.classList.contains('hidden')) {
        closeModal();
      }
    });
    
    // Handle form submission
    form?.addEventListener('submit', async (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      // Check if form is valid using HTML5 validation
      if (!form.checkValidity()) {
        // Show validation messages without closing modal
        form.reportValidity();
        return;
      }
      
      // Update subject line with actual customer data
      const nameField = document.getElementById('name');
      const addressField = document.getElementById('address');
      const subjectField = document.getElementById('form-subject');
      
      if (nameField && addressField && subjectField) {
        const customerName = nameField.value;
        const customerAddress = addressField.value;
        subjectField.value = `New Estimate Request - ${customerName} / ${customerAddress}`;
      }
      
      const formData = new FormData(form);
      
      // Show loading state
      const submitBtn = form.querySelector('button[type="submit"]');
      const originalText = submitBtn?.textContent;
      if (submitBtn) {
        submitBtn.disabled = true;
        submitBtn.textContent = 'Sending...';
      }
      
      try {
        const response = await fetch(form.action, {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        });
        
        if (response.ok) {
          form.classList.add('hidden');
          successMessage?.classList.remove('hidden');
          // Hide header and description when showing success
          modalHeader?.classList.add('hidden');
          modalDescription?.classList.add('hidden');
          
          // Track event
          if (typeof trackEvent !== 'undefined') {
            trackEvent('Submit', { category: 'Form', label: 'Estimate Request' });
          }
          
          // Auto-close after 12 seconds
          setTimeout(() => {
            closeModal();
            form.classList.remove('hidden');
            if (submitBtn) {
              submitBtn.disabled = false;
              submitBtn.textContent = originalText;
            }
          }, 12000);
        } else {
          alert('There was a problem submitting your request. Please call us at 904-408-2450.');
          if (submitBtn) {
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
          }
        }
      } catch (error) {
        alert('There was a problem submitting your request. Please call us at 904-408-2450.');
        if (submitBtn) {
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
        }
      }
    });
  </script>
  
  <!-- Carousel Script -->
  <script>
    let currentSlide = 0;
    const slides = document.querySelectorAll('.carousel-slide');
    const indicators = document.querySelectorAll('.carousel-indicator');
    const totalSlides = slides.length;
    
    function showSlide(index) {
      slides.forEach((slide, i) => {
        if (i === index) {
          slide.classList.remove('opacity-0');
        } else {
          slide.classList.add('opacity-0');
        }
      });
      
      indicators.forEach((indicator, i) => {
        if (i === index) {
          indicator.classList.remove('bg-gray-500');
          indicator.classList.add('bg-brand-yellow');
        } else {
          indicator.classList.remove('bg-brand-yellow');
          indicator.classList.add('bg-gray-500');
        }
      });
    }
    
    function nextSlide() {
      currentSlide = (currentSlide + 1) % totalSlides;
      showSlide(currentSlide);
    }
    
    function prevSlide() {
      currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
      showSlide(currentSlide);
    }
    
    // Auto-advance carousel every 5 seconds
    setInterval(nextSlide, 5000);
    
    // Button event listeners
    document.getElementById('next-btn')?.addEventListener('click', nextSlide);
    document.getElementById('prev-btn')?.addEventListener('click', prevSlide);
    
    // Indicator event listeners
    indicators.forEach((indicator, index) => {
      indicator.addEventListener('click', () => {
        currentSlide = index;
        showSlide(currentSlide);
      });
    });
  </script>
</BaseLayout>
